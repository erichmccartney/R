setwd("~/GitHub/R/DataSets")
d <- read.csv("Cryptosporidium.csv")
str(d)
colSums(is.na(d))                                 # Check for missing data
d <- d[complete.cases(d),]
length(unique(d$ID))
setwd("~/GitHub/R/DataSets")
d <- read.csv("OatsYield.csv")
str(d)
summary(d)
View(d)
hist(d$yield)                                   # Misleading histogram: has different varieties
library(lattice)
histogram(~yield, data=d)
densityplot(~yield, data=d)
densityplot(~yield | variety, data=d)
densityplot(~yield | block, data=d)
densityplot(~yield | variety*block, data=d)
bwplot(yield ~ variety, data=d)
bwplot(yield ~ block, data=d)
bwplot(yield ~ block | variety, data=d)
xyplot(yield ~ nitrogen | variety, data=d)
xyplot(yield ~ nitrogen | block, data=d)
xyplot(yield ~ nitrogen | variety*block, data=d)
ols <- lm(yield ~ nitrogen*variety, data=d)
summary(ols)
fe <- lm(yield ~ nitrogen*variety + block, data=d)
summary(fe)
confint(fe)
d$variety <- relevel(d$variety, ref="Victory")
d$variety ,- factor(d$variety)
d$variety <- factor(d$variety)
d$variety <- relevel(d$variety, ref="Victory")
fe <- lm(yield ~ nitrogen*variety + block, data=d)
summary(fe)
library(lme4)
re <- lmer(yield ~ nitrogen*variety + (1 | block), data=d, REML=FALSE)
summary(re)
confint(re)
AIC(re)
fixef(re)                                       # Magnitude of fixed effects
ranef(re)                                       # Magnitude of random effects
coef(re)                                        # Magnitude of total effects
library(stargazer)
stargazer(ols, fe, re, type="text", single.row=TRUE)
AIC(ols, fe, re)
