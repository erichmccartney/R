library(readxl)
setwd("~/GitHub/R/DataSets")
df <- read_excel("HealthInsurance.xlsx", sheet='Data')
dim(df)
str(df)
View(df)
#' Data visualizations
hist(df$medexpense)
hist(log(df$medexpense))
colSums(is.na(df)) #no missing values
which(! complete.cases(df)) #no missing values
df1 <- df[, -c(11, 14:15, 28:29)]
temp <- df1[, c(1:10)]
library(PerformanceAnalytics)
chart.Correlation(temp)
library(stargazer)
m1 <- lm(medexpense ~ healthins + female + blackhisp + age*income + illnesses + ssiratio + private +
married + msa, data = df1)
m2 <- lm(medexpense ~ healthins + age + female + blackhisp + logincome + illnesses +  ssiratio +private +
married + msa + lowincome, data=df1)
m3 <- lm(medexpense ~ age + female + blackhisp + logincome + illnesses +  ssiratio +private +
married + msa + poverty, data=df1)
stargazer(m1, m2, m3, type='text', single.row=TRUE)
plot(m1)
bartlett.test(list(m2$res, m2$fit))         # Bartlett's test of homoskedasticity
bartlett.test(list(m5$res, m5$fit))
shapiro.test(m1$res)                        # Shapiro-Wilk's test of multivariate normality
shapiro.test(m1$res)
df2 <- df1[sample(1:nrow(df1),5000),]
m1 <- lm(medexpense ~ healthins + female + blackhisp + age*income + illnesses + ssiratio + private +
married + msa, data = df2)
m2 <- lm(medexpense ~ healthins + age + female + blackhisp + logincome + illnesses +  ssiratio +private +
married + msa + lowincome, data=df2)
m3 <- lm(medexpense ~ age + female + blackhisp + logincome + illnesses +  ssiratio +private +
married + msa + poverty, data=df2)
stargazer(m1, m2, m3, type='text', single.row=TRUE)
plot(m1)
shapiro.test(m1$res)                        # Shapiro-Wilk's test of multivariate normality
bartlett.test(list(m1$res, m1$fit))         # Bartlett's test of homoskedasticity
library("car")                              # Multicollinearity test
vif(m1)
library(lmtest)
dwtest(m1)                                  # Durbin-Watson test of autocorrelation
